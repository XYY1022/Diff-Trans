# Description
In this study, the Diffusion model and Transformer model are combined to solve the problem of insufficient data in flood prediction. The diffusion model is used for data expansion and the Transformer model is used for flood flow prediction. We use the flood prediction data of Wanan Reservoir, Zhexi Reservoir and Pankou Reservoir as the data set to forecast, and the results show that the prediction effect is better than the traditional model in most cases.
![image](https://github.com/user-attachments/assets/08d204b0-51a3-4e2a-950f-50e0841fad16)
# Code
## Dataset Preparation
The data set we use is the flood data collected from Wan 'an Reservoir, Zhe Xi Reservoir and Pankou Reservoir, including the hydrological and rainfall information of the basin.Due to the nature of this study, the participants did not consent to public sharing of their data.
## Training & Predicting
The implementation of the methodology is divided into three folders. 
For data enhance, You can go to the Diffusion folder and run it to reproduce the results of all the benchmarks：

`(myenv) $ python main.py --name {name} --config_file {config.yaml} --gpu 0 --train`

While training, the script will save check points to the results folder after a fixed number of epochs. Once trained, please use the saved model for sampling by running：

`(myenv) $ python main.py --name {name} --config_file {config.yaml} --gpu 0 --sample 0 --milestone {checkpoint_number}`

The synthesized data and raw data are stored in file format under the output folder. We go into the Transofmrer folder and use the synthetic data generated by Diffusion to make the prediction and get the prediction result.
## Evaluation
Go to the Transformer_pre folder and use the predicted and real data to calculate parameters such as NSE, R2, RMSE, and RE for evaluation.
